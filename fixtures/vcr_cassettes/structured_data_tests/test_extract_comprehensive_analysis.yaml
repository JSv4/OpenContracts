interactions:
- request:
    body: '{"messages":[{"role":"system","content":"<BACKGROUND_CONTEXT>\nYou are
      an expert assistant for document analysis and interpretation. Your primary goal
      is to answer questions accurately based on document ''Test Doc'' (ID: 1).\n\nThis
      document is described as:\n`USC Title 1 - Chapter 1`\n\n**Available Tools:**\nYou
      have access to a comprehensive set of tools for document analysis:\n\n1. **Vector
      Search**: A sophisticated semantic search engine that finds text passages similar
      to your queries.\n2. **Document Summary Access**: Tools to load and analyze
      the document''s markdown summary, including:\n   - Loading full or truncated
      summary content\n   - Calculating token lengths for context management\n3. **Notes
      Analysis**: Tools to retrieve and examine notes attached to this document:\n   -
      Listing all notes with metadata\n   - Accessing specific note content\n   -
      Calculating note token lengths\n\n**Important**: Always check what tools are
      available to you, as additional specialized tools may be provided dynamically
      beyond the core set described above. Use the appropriate tools to gather information
      before answering.\n\n**Guidelines:**\n- Prioritize information retrieved directly
      from the document using these tools\n- We intentionally did not give you the
      entire document initially. \n  Try doing some vector search to get more information
      initially and then iteratively \n  identifying which parts of the document to
      review.  \n- Do not rely solely on the summary or your general knowledge\n-
      Use multiple tools when necessary for comprehensive answers\n- Present your
      findings in clear, helpful markdown format\n- Avoid repeating instructions or
      disclaimers in your responses\n</BACKGROUND_CONTEXT>\n\nYou are a highly-intelligent
      data extraction system with advanced verification capabilities.\n\nEXTRACTION
      METHODOLOGY:\n1. GATHER: Use available tools (similarity_search, load_document_md_summary,
      etc.) to find ALL relevant information\n2. EXTRACT: Identify the specific data
      requested in: \"Perform a comprehensive analysis of the ''Respect for Marriage
      Act'' amendment to Section 7.\"\n3. VERIFY: Before outputting, internally validate
      your extraction by:\n   - Confirming the requested information ACTUALLY EXISTS
      in the document\n   - Cross-referencing multiple sources if available\n   -
      Checking for logical consistency (dates in order, numbers reasonable, etc.)\n   -
      Ensuring no placeholder or generic values (like \"N/A\" unless actually in the
      document)\n   - Confirming extracted text actually appears in the source material\n   -
      For lists/collections: searching again with different queries to ensure completeness\n\nCRITICAL
      RULES:\n- If the requested information does not exist or is not applicable to
      this document, return null\n- If a question doesn''t make sense for this document
      type, return null\n- NEVER invent, guess, or infer data that isn''t explicitly
      present\n- If data is not found after thorough search, return null/empty rather
      than guessing\n- If multiple conflicting values exist, choose the most authoritative/recent\n-
      For numeric values, verify they make sense in context\n- For dates, ensure they
      follow logical chronology and are actually present\n- For names/entities, verify
      exact spelling from the source\n- For boolean questions, only return true/false
      if you can definitively answer based on document content\n\nYour response must
      be ONLY the extracted data in the format of: a JSON object matching the ''ContractAnalysis''
      model structure\n\nNo explanations, no process description, no confidence scores
      - just the final verified JSON.\n\nJSON Schema for your response:\n```json\n{\n  \"$defs\":
      {\n    \"ContractParty\": {\n      \"description\": \"A party to a contract.\",\n      \"properties\":
      {\n        \"name\": {\n          \"description\": \"Full legal name\",\n          \"title\":
      \"Name\",\n          \"type\": \"string\"\n        },\n        \"role\": {\n          \"description\":
      \"Role in contract (e.g., ''Buyer'', ''Seller'', ''Service Provider'')\",\n          \"title\":
      \"Role\",\n          \"type\": \"string\"\n        },\n        \"address\":
      {\n          \"anyOf\": [\n            {\n              \"type\": \"string\"\n            },\n            {\n              \"type\":
      \"null\"\n            }\n          ],\n          \"default\": null,\n          \"description\":
      \"Business address if mentioned\",\n          \"title\": \"Address\"\n        }\n      },\n      \"required\":
      [\n        \"name\",\n        \"role\"\n      ],\n      \"title\": \"ContractParty\",\n      \"type\":
      \"object\"\n    }\n  },\n  \"description\": \"Comprehensive contract analysis
      results.\",\n  \"properties\": {\n    \"title\": {\n      \"description\": \"Contract
      title or type\",\n      \"title\": \"Title\",\n      \"type\": \"string\"\n    },\n    \"parties\":
      {\n      \"description\": \"All parties to the contract\",\n      \"items\":
      {\n        \"$ref\": \"#/$defs/ContractParty\"\n      },\n      \"title\": \"Parties\",\n      \"type\":
      \"array\"\n    },\n    \"total_value\": {\n      \"anyOf\": [\n        {\n          \"type\":
      \"number\"\n        },\n        {\n          \"type\": \"null\"\n        }\n      ],\n      \"default\":
      null,\n      \"description\": \"Total contract value in dollars\",\n      \"title\":
      \"Total Value\"\n    },\n    \"term_months\": {\n      \"anyOf\": [\n        {\n          \"type\":
      \"integer\"\n        },\n        {\n          \"type\": \"null\"\n        }\n      ],\n      \"default\":
      null,\n      \"description\": \"Contract term in months\",\n      \"title\":
      \"Term Months\"\n    },\n    \"governing_law\": {\n      \"anyOf\": [\n        {\n          \"type\":
      \"string\"\n        },\n        {\n          \"type\": \"null\"\n        }\n      ],\n      \"default\":
      null,\n      \"description\": \"Governing law jurisdiction\",\n      \"title\":
      \"Governing Law\"\n    },\n    \"key_obligations\": {\n      \"description\":
      \"Key obligations for each party\",\n      \"items\": {\n        \"type\": \"string\"\n      },\n      \"title\":
      \"Key Obligations\",\n      \"type\": \"array\"\n    },\n    \"risk_factors\":
      {\n      \"description\": \"Identified risk factors\",\n      \"items\": {\n        \"type\":
      \"string\"\n      },\n      \"title\": \"Risk Factors\",\n      \"type\": \"array\"\n    },\n    \"public_law_number\":
      {\n      \"anyOf\": [\n        {\n          \"type\": \"string\"\n        },\n        {\n          \"type\":
      \"null\"\n        }\n      ],\n      \"default\": null,\n      \"description\":
      \"Public law number pertaining to the amendment\",\n      \"title\": \"Public
      Law Number\"\n    },\n    \"amendment_year\": {\n      \"anyOf\": [\n        {\n          \"type\":
      \"integer\"\n        },\n        {\n          \"type\": \"null\"\n        }\n      ],\n      \"default\":
      null,\n      \"description\": \"Year the section was amended\",\n      \"title\":
      \"Amendment Year\"\n    }\n  },\n  \"required\": [\n    \"title\",\n    \"parties\",\n    \"key_obligations\"\n  ],\n  \"title\":
      \"ContractAnalysis\",\n  \"type\": \"object\"\n}\n```"},{"role":"user","content":"Perform
      a comprehensive analysis of the ''Respect for Marriage Act'' amendment to Section
      7."}],"model":"gpt-4o-mini","stream":false,"temperature":0.7,"tool_choice":"required","tools":[{"type":"function","function":{"name":"final_result","description":"Comprehensive
      contract analysis results.","parameters":{"properties":{"title":{"description":"Contract
      title or type","type":"string"},"parties":{"description":"All parties to the
      contract","items":{"$ref":"#/$defs/ContractParty"},"type":"array"},"total_value":{"anyOf":[{"type":"number"},{"type":"null"}],"description":"Total
      contract value in dollars"},"term_months":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Contract
      term in months"},"governing_law":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Governing
      law jurisdiction"},"key_obligations":{"description":"Key obligations for each
      party","items":{"type":"string"},"type":"array"},"risk_factors":{"description":"Identified
      risk factors","items":{"type":"string"},"type":"array"},"public_law_number":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Public
      law number pertaining to the amendment"},"amendment_year":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"Year
      the section was amended"}},"required":["title","parties","key_obligations"],"type":"object","$defs":{"ContractParty":{"description":"A
      party to a contract.","properties":{"name":{"description":"Full legal name","type":"string"},"role":{"description":"Role
      in contract (e.g., ''Buyer'', ''Seller'', ''Service Provider'')","type":"string"},"address":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Business
      address if mentioned"}},"required":["name","role"],"type":"object"}}}}}]}'
    headers:
      accept:
      - application/json
      accept-encoding:
      - gzip, deflate
      connection:
      - keep-alive
      content-length:
      - '8824'
      content-type:
      - application/json
      cookie:
      - __cf_bm=v9Slg21i2yr0blW7WDX1hu7JKBc1EZ_aTLYSmJATqOA-1751734072-1.0.1.1-RSuNwUxbx7LA1Ekz1C5d5zepwxxBjV6y9v59Rg.wdc5AZ0Ptfv52eGr9ywiPhBL2Io5Huzg0XMfWomOHBDuBQCR.yu4hknV9TPgPNg_wp.w;
        _cfuvid=kMKUTBGLMaKftLBwLgoFNITkjQukVlSgpJGCbONDQEU-1751734072392-0.0.1.1-604800000
      host:
      - api.openai.com
      user-agent:
      - pydantic-ai/0.2.16
      x-stainless-arch:
      - x64
      x-stainless-async:
      - async:asyncio
      x-stainless-lang:
      - python
      x-stainless-os:
      - Linux
      x-stainless-package-version:
      - 1.81.0
      x-stainless-read-timeout:
      - '600'
      x-stainless-retry-count:
      - '1'
      x-stainless-runtime:
      - CPython
      x-stainless-runtime-version:
      - 3.12.11
    method: POST
    uri: https://api.openai.com/v1/chat/completions
  response:
    body:
      string: !!binary |
        H4sIAAAAAAAAAwAAAP//jFRNT+MwEL33V1hzTlGbdmnpDYQEK8Fqd7sf2iUomtqT1ODYwXaAqup/
        X9mlTVo4bA6R4+f35s14JuseYyAFzBjwJXpe1ap/8TS4vZrfXGKxLK9eL6YO6fr6/Puj8+NaQRIY
        ZvFA3O9YJ9xUtSIvjd7C3BJ6CqrDyafhZDQejtIIVEaQCrSy9v2x6VdSy346SMf9waQ/nL6xl0Zy
        cjBjdz3GGFvHd/CpBb3CjA2S3U5FzmFJMNsfYgysUWEH0DnpPGoPSQtyoz3pYF03SnUAb4zKOSrV
        Bt4+6866LRYqlX/53Qzm81+Xf68+022l0oenP/jNjZadeFvpVR0NFY3m+yJ18P3+7CgYY6Cx2nKl
        RpVbco3yR3zGAG3ZVKR98A7rDLz0ijKYZfCdXE3cs8JYdovWSiyJnXOfQZJBjdZLchnM7tZZDBU5
        P7X0JNjcow9gksWSRujKPJPVIVQGm6RLOleKSS3ksxQNKsewKIgHmcWKVbvACl+OBL82CyV5Bpv7
        JINHWuVmoWSJoRzRVwY/DLNvSaAWrKmXRolWkp4aVNKvYoZ4aCJhlkq0QpFzzBTM0WvCStKCbMKM
        Dd8NKmasJO1jzJMMgpE6usoVvuS6qRZkO17ZDb6w4XDST9NpzAUr0iKUJF8RhpPpIE03cHBHm95H
        6/tO/1kqGofqfWOi1mZrLnbm/Ruy2Q+BMmVtzcIdUUPLSLfMLaGLvdVt8d7OSLQAzcEUQW1NVfvc
        m0eKQYenZ6OtLLSj3sJnbwMJ3nhUHdpkuqMdKOaCPMo4aPvZ5siXJFpuO+PYCGk6QK+T/Xs7H2lv
        KyB1+T/yLcA51Z5EXlsSkh+m3B6z9BD7/ONj+zpHw+DIPktOuZdkw40IKnA30OBWzlOVF1KXZGsr
        418Kijo/TTEd4XRIBfQ2vX8AAAD//wMAGbYSSrMFAAA=
    headers:
      CF-RAY:
      - 95a85a345818eb2f-DFW
      Connection:
      - keep-alive
      Content-Encoding:
      - gzip
      Content-Type:
      - application/json
      Date:
      - Sat, 05 Jul 2025 16:48:53 GMT
      Server:
      - cloudflare
      Transfer-Encoding:
      - chunked
      X-Content-Type-Options:
      - nosniff
      access-control-expose-headers:
      - X-Request-ID
      alt-svc:
      - h3=":443"; ma=86400
      cf-cache-status:
      - DYNAMIC
      openai-organization:
      - user-54labie7aicgek5urzpgydpm
      openai-processing-ms:
      - '1432'
      openai-version:
      - '2020-10-01'
      strict-transport-security:
      - max-age=31536000; includeSubDomains; preload
      x-envoy-upstream-service-time:
      - '1435'
      x-ratelimit-limit-requests:
      - '5000'
      x-ratelimit-limit-tokens:
      - '4000000'
      x-ratelimit-remaining-requests:
      - '4999'
      x-ratelimit-remaining-tokens:
      - '3998336'
      x-ratelimit-reset-requests:
      - 12ms
      x-ratelimit-reset-tokens:
      - 24ms
      x-request-id:
      - req_bd5254dd7c84816ab91df70d51942760
    status:
      code: 200
      message: OK
version: 1
